<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blog - Verygood Chocolate</title>
    <meta name="description" content="Verygood Chocolate News & Stories">
    <meta name="google-adsense-account" content="ca-pub-3053552886884428">
    <link rel="stylesheet" href="./styles.css">
    <!-- CMS Data -->
    <script src="./assets/data/blogs.js"></script>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3053552886884428"
        crossorigin="anonymous"></script>

    <style>
        .blog-page {
            max-width: 1200px;
            margin: 140px auto 100px;
            padding: 0 24px;
        }

        .blog-header {
            text-align: center;
            margin-bottom: 60px;
        }

        .blog-title {
            font-family: var(--menu-font);
            font-size: 36px;
            margin-bottom: 12px;
        }

        .blog-sub {
            color: rgba(0, 0, 0, 0.6);
            font-size: 16px;
        }

        .blog-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 40px;
        }

        .blog-card {
            display: flex;
            flex-direction: column;
            text-decoration: none;
            color: inherit;
            group: ;
        }

        .blog-card:hover .blog-thumb img {
            transform: scale(1.05);
        }

        .blog-card:hover .blog-card-title {
            color: var(--brand);
        }

        .blog-thumb {
            width: 100%;
            height: 240px;
            border-radius: var(--radius);
            overflow: hidden;
            background: #eee;
            margin-bottom: 20px;
        }

        .blog-thumb img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.4s;
        }

        .blog-meta {
            font-size: 12px;
            color: #999;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .blog-card-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 10px;
            line-height: 1.4;
            transition: color 0.2s;
        }

        .blog-summary {
            font-size: 15px;
            color: #555;
            line-height: 1.6;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        /* Language Toggle Switch (Reused) */
        .lang-switch {
            display: flex;
            align-items: center;
            background: #f0f0f0;
            border-radius: 20px;
            padding: 4px;
            cursor: pointer;
            border: none;
            margin-right: 12px;
            position: relative;
            width: 64px;
            height: 32px;
            transition: background 0.3s;
            outline: none;
            -webkit-tap-highlight-color: transparent;
        }

        .lang-switch .toggle-circle {
            width: 24px;
            height: 24px;
            background: white;
            border-radius: 50%;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            position: absolute;
            left: 4px;
            top: 4px;
            transition: transform 0.3s cubic-bezier(0.4, 0.0, 0.2, 1);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            font-weight: 800;
            color: var(--brand);
        }

        .lang-switch.is-kr {
            background: var(--brand);
        }

        .lang-switch.is-kr .toggle-circle {
            transform: translateX(32px);
            color: #333;
        }
    </style>
</head>

<body>
    <header class="topbar">
        <div class="topbar-left">
            <button class="icon-btn" onclick="location.href='./index.html'">
                <span class="icon">←</span><span class="txt">Home</span>
            </button>
        </div>
        <a class="brand" href="./index.html">
            <img class="brand-img" src="./assets/logo-type.png" alt="VERYGOOD">
        </a>
        <nav class="topbar-actions" aria-label="Top actions">
            <button class="lang-switch" id="langToggle" aria-label="Switch language">
                <span class="toggle-circle">EN</span>
            </button>
            <a class="cta" href="./index.html#shop">ORDER</a>
        </nav>
    </header>

    <main class="blog-page">
        <div class="blog-header">
            <h1 class="blog-title">Journal & News</h1>
            <p class="blog-sub">Stories from Verygood Chocolate.</p>
        </div>

        <div class="blog-grid" id="blogGrid">
            <!-- Rendered by JS -->
        </div>
    </main>

    <footer class="footer">
        <div class="footer-inner">
            <div class="footer-left">
                <div class="footer-brand">VERYGOOD CHOCOLATE</div>
                <div class="footer-small">© <span id="year"></span> Verygood. All rights reserved.</div>
            </div>
            <div class="footer-right">
                <a href="./privacy.html"
                    style="font-size:13px; opacity:0.7; margin-right:15px; text-decoration:none;">Privacy Policy</a>
                <a href="./terms.html"
                    style="font-size:13px; opacity:0.7; margin-right:15px; text-decoration:none;">Terms of Service</a>
            </div>
        </div>
    </footer>

    <script>
        document.getElementById("year").textContent = new Date().getFullYear();

        // 1. Language State
        const params = new URLSearchParams(window.location.search);
        let currentLang = params.get("lang") || "EN";

        function updateUI() {
            const isKr = currentLang === "KR";

            // Toggle Button
            const toggleBtn = document.getElementById("langToggle");
            toggleBtn.classList.toggle("is-kr", isKr);
            toggleBtn.querySelector(".toggle-circle").textContent = isKr ? "KR" : "EN";

            // Header Texts
            document.querySelector(".blog-title").textContent = isKr ? "저널 & 뉴스" : "Journal & News";
            document.querySelector(".blog-sub").textContent = isKr ? "베리굿초콜릿의 이야기들." : "Stories from Verygood Chocolate.";
            document.querySelector(".topbar-left .txt").textContent = isKr ? "홈으로" : "Home";

            // Render Grid
            const grid = document.getElementById("blogGrid");
            grid.innerHTML = blogs.map(post => `
                <a href="./blog-detail.html?id=${post.id}&lang=${currentLang}" class="blog-card">
                    <div class="blog-thumb">
                        <img src="${post.thumbnail}" alt="${post.title}" loading="lazy">
                    </div>
                    <div class="blog-meta">${post.date}</div>
                    <div class="blog-card-title">${(isKr && post.title_ko) ? post.title_ko : post.title}</div>
                    <div class="blog-summary">${(isKr && post.summary_ko) ? post.summary_ko : post.summary}</div>
                </a>
            `).join("");
        }

        // Init
        updateUI();

        // Toggle Event
        document.getElementById("langToggle").addEventListener("click", () => {
            currentLang = currentLang === "EN" ? "KR" : "EN";

            // Update URL without reload if possible, or just re-render
            const newUrl = new URL(window.location);
            newUrl.searchParams.set("lang", currentLang);
            window.history.replaceState({}, "", newUrl);

            updateUI();
        });
    </script>
</body>

</html>